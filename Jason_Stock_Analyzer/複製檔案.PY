import shutil
import os
from pathlib import Path

# ä¾†æºæª”æ¡ˆè·¯å¾‘
SOURCE_FILE = r"Y:\æ”¶æ”¯è¨˜éŒ„\è‚¡ç¥¨åˆ†æ\è‚¡ç¥¨åˆ†æ.xlsx"
# ç›®æ¨™ç›®éŒ„è·¯å¾‘
BASE_DIR = os.path.join(os.path.dirname(os.path.abspath(__file__)))
EXCEL_PATH = BASE_DIR + "/datas/è‚¡ç¥¨åˆ†æ.xlsx"
DESTINATION_DIR = EXCEL_PATH # ä¹Ÿå°±æ˜¯ D æ§½çš„æ ¹ç›®éŒ„

# å°‡æŒ‡å®šæª”æ¡ˆè¤‡è£½åˆ°ç›®æ¨™ç›®éŒ„ã€‚
def copy_file_to_directory(source: str, destination: str):
    """
    å°‡æŒ‡å®šæª”æ¡ˆè¤‡è£½åˆ°ç›®æ¨™ç›®éŒ„ã€‚
    """
    source_path = Path(source)
    destination_dir_path = Path(destination)
    
    print(f"âœ… æ­£åœ¨æº–å‚™è¤‡è£½æª”æ¡ˆ...")
    print(f"ä¾†æº: {source_path}")
    print(f"ç›®æ¨™ç›®éŒ„: {destination_dir_path}")

    # 1. æª¢æŸ¥ä¾†æºæª”æ¡ˆæ˜¯å¦å­˜åœ¨
    if not source_path.exists() or not source_path.is_file():
        print(f"âŒ éŒ¯èª¤ï¼šæ‰¾ä¸åˆ°ä¾†æºæª”æ¡ˆæˆ–ä¾†æºä¸æ˜¯ä¸€å€‹æª”æ¡ˆ: {source}")
        return

    # 2. æª¢æŸ¥ç›®æ¨™ç›®éŒ„æ˜¯å¦å­˜åœ¨ (å¦‚æœä¸å­˜åœ¨ï¼Œshutil.copy æœƒè‡ªå‹•å‰µå»ºï¼Œä½†æˆ‘å€‘æœ€å¥½å…ˆæª¢æŸ¥ä¸¦åˆ—å°è¨Šæ¯)
    if not destination_dir_path.exists():
        print(f"âš ï¸ è­¦å‘Šï¼šç›®æ¨™ç›®éŒ„ '{destination}' ä¸å­˜åœ¨ï¼Œæ­£åœ¨å˜—è©¦å»ºç«‹...")
        try:
            destination_dir_path.mkdir(parents=True, exist_ok=True)
        except Exception as e:
            print(f"âŒ éŒ¯èª¤ï¼šç„¡æ³•å»ºç«‹ç›®æ¨™ç›®éŒ„: {e}")
            return
    
    try:
        # 3. åŸ·è¡Œè¤‡è£½æ“ä½œ
        # shutil.copy æœƒå°‡æª”æ¡ˆè¤‡è£½åˆ°ç›®éŒ„ä¸­ï¼Œä¸¦ä¿ç•™åŸå§‹æª”æ¡ˆå
        shutil.copy(source, destination)
        
        # å»ºç«‹å®Œæ•´çš„ç›®æ¨™è·¯å¾‘ç”¨æ–¼è¼¸å‡ºè¨Šæ¯
        destination_file_path = destination_dir_path / source_path.name
        
        print("\n" + "="*50)
        print("ğŸ‰ æª”æ¡ˆè¤‡è£½æˆåŠŸï¼")
        print(f"æ–°æª”æ¡ˆä½ç½®: {destination_file_path}")
        print("="*50)

    except Exception as e:
        print(f"âŒ è¤‡è£½æª”æ¡ˆæ™‚ç™¼ç”ŸéŒ¯èª¤: {e}")

# åŸ·è¡Œè¤‡è£½åŠŸèƒ½
copy_file_to_directory(SOURCE_FILE, DESTINATION_DIR)